[...TRUNCATED FOR BREVITY IN THIS CELL... See next message for full code...]